<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Click-to-Advance Slideshow — Crossfade, Contain, Smart Upscale</title>
  <style>
    :root { --bg: #ffe6f0; --fg: #222; --muted: #6a6a6a; }
    html, body { height: 100%; }
    body {
      margin: 0;
      background: var(--bg);
      color: var(--fg);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      overflow: hidden;
    }

    .stage {
      position: fixed; inset: 0;
      display: grid; place-items: center;
      cursor: pointer;
      user-select: none;
    }

    .stack { position: relative; width: 100vw; height: 100vh; }
    .slide {
      position: absolute; inset: 0; margin: auto;
      display: block;
      opacity: 0; transition: opacity 350ms ease;
      image-rendering: auto;
      pointer-events: none;
    }
    .slide.is-visible { opacity: 1; }

    .overlay {
      position: fixed; left: 50%; bottom: 12px; transform: translateX(-50%);
      font-size: 12px; color: var(--muted);
      background: rgba(0,0,0,0.08); padding: 6px 10px; border-radius: 10px;
      backdrop-filter: blur(2px);
    }

    .home {
      position: fixed; left: 12px; bottom: 12px; z-index: 20;
      padding: 6px 10px; border-radius: 10px; border: 1px solid rgba(0,0,0,0.15);
      background: rgba(255,255,255,0.7); color: #111; font-size: 16px;
      backdrop-filter: blur(2px);
      cursor: pointer; user-select: none;
    }
    .home:hover { background: rgba(255,255,255,0.9); }
  </style>
</head>
<body>
  <div id="stage" class="stage" title="Click to go to next image (←/→ also work)">
    <div class="stack" aria-live="polite" aria-atomic="true">
      <img id="imgA" class="slide" alt="" />
      <img id="imgB" class="slide" alt="" />
    </div>
  </div>
  <div id="info" class="overlay">0 / 0</div>
  <button id="homeBtn" class="home" title="Go to first & randomize others">⌂</button>

  <script>
    const IMAGES = [
      "https://cdn.discordapp.com/attachments/709821851446280234/1428518595058471023/KepRoom.png?ex=68f2cb1d&is=68f1799d&hm=6f6476fe72843b8ac08beaf196946d3ca2b227b79adf05687675f63f56b8b8ba&",
      "https://d.furaffinity.net/art/hungrykep/1751140965/1751140965.hungrykep_ych_animated_bj.gif",
      "https://d.furaffinity.net/art/hungrykep/1751818888/1751818888.hungrykep_img_3085.gif",
      "https://d.furaffinity.net/art/hungrykep/1746925910/1746925910.hungrykep_img_2984.gif",
      "https://static1.e621.net/data/f2/07/f20703a4320cbb3870a2902ae97525e8.webm"
    ];

    const info = document.getElementById('info');
    const stage = document.getElementById('stage');
    const imgA = document.getElementById('imgA');
    const imgB = document.getElementById('imgB');
    const homeBtn = document.getElementById('homeBtn');

    let index = 0;
    let front = imgA;
    let back = imgB;

    function updateInfo(){ info.textContent = `${IMAGES.length ? index + 1 : 0} / ${IMAGES.length}`; }

    function sizeToViewport(img){
      const vw = window.innerWidth; const vh = window.innerHeight;
      const nw = img.naturalWidth;  const nh = img.naturalHeight;
      if (!nw || !nh) return;

      const scaleToFit = Math.min(vw / nw, vh / nh);
      const bothSmaller = (nw < vw && nh < vh);
      const scale = bothSmaller ? scaleToFit : Math.min(1, scaleToFit);

      const dispW = Math.round(nw * scale);
      const dispH = Math.round(nh * scale);
      img.style.width  = dispW + 'px';
      img.style.height = dispH + 'px';
    }

    function preload(url){ const im = new Image(); im.src = url; }

    function showImage(i){
      if (!IMAGES.length) return;
      index = (i + IMAGES.length) % IMAGES.length;
      const nextSrc = IMAGES[index];

      const token = Symbol();
      back._loadToken = token;
      front.classList.add('is-visible');

      back.onload = () => {
        if (back._loadToken !== token) return;
        sizeToViewport(back);
        back.classList.add('is-visible');
        front.classList.remove('is-visible');
        [front, back] = [back, front];
        updateInfo();
        preload(IMAGES[(index + 1) % IMAGES.length]);
      };
      back.src = nextSrc;
    }

    function shuffleTail(arr){
      if (arr.length <= 2) return;
      for (let j = arr.length - 1; j > 1; j--) {
        const k = 1 + Math.floor(Math.random() * j);
        [arr[j], arr[k]] = [arr[k], arr[j]];
      }
    }

    homeBtn.addEventListener('click', (e)=>{
      e.stopPropagation();
      shuffleTail(IMAGES);
      showImage(0);
    });

    stage.addEventListener('click', () => showImage(index + 1));
    window.addEventListener('keydown', (e) => {
      if (!IMAGES.length) return;
      if (e.key === 'ArrowRight' || e.key === ' ') { e.preventDefault(); showImage(index + 1); }
      else if (e.key === 'ArrowLeft') { e.preventDefault(); showImage(index - 1); }
    });

    window.addEventListener('resize', () => {
      sizeToViewport(front);
      sizeToViewport(back);
    });

    (function init(){
      updateInfo();
      if (!IMAGES.length) return;
      const first = IMAGES[0];
      front.onload = () => { sizeToViewport(front); front.classList.add('is-visible'); updateInfo(); preload(IMAGES[1 % IMAGES.length]); };
      front.src = first;
    })();
  </script>
</body>
</html>
